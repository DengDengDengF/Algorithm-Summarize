### 图片压缩结合并发内存考虑

![image.png](https://s2.loli.net/2025/12/25/G4t7COv5kbZQAxP.png)

```js
图片压缩占用内存再100mb，以内体验最好。故而，把12mb以上的直接pass了。
确保并发过程中内存占用始终100mb上下
已知，接口同时并发5个。
let memoryHash={1:9.6,2:19.2,......,12:115.2}
若有以下文件列表imgSizeList = [2mb,3.1mb,4.2mb,5mb,1mb,2mb,3mb]
const maxlimit = 120
let tempSize = 0,num = 0,oldIndex = 0, newIndex = 0,length = imgSizeList.length
while(newIndex < length){
    while(tempSize < maxlimit && newIndex < length){
      const k = Math.ceil(imgSizeList[newIndex])
      const space = memoryHash(k)
      tempSize += space
      newIndex++
    }
    //oldIndex 到 newIndex区间先去做 worker并发`抽样`MD5 、压缩图片（占内存）
}
想压缩到指定大小 匹配 指定的像素，绝对不能遍历，要根据宽高比一次计算
```

